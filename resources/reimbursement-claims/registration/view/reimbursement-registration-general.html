<nav class="navbar pt-1 pb-1">
    <span class="navbar-brand p-0 m-0" ui-sref="reimbursement-registration">
        <i class="fa fa-arrow-left" style="cursor:pointer"></i>&nbsp;&nbsp;Claim Registration</span>
    <!-- <span class="navbar-brand p-0 m-0" ng-click="toggleUpload();"><i class="fa fa-plus-square-o" style="font-size: larger"></i></span> -->
</nav>
<section class="">
    <div class="leftContainer" ng-class="{'col-sm-12' : !showUpload, 'col-sm-7' : showUpload}">
        <div class="searchBar" ng-if="isNew">
            <div class="searchBarRow">
                <div layout-gt-sm="row" style="height:auto !important">
                    <div style="border-left: 1px solid #e6e6e6; width: 100% !important;">
                        <md-input-container flex-gt-sm>
                            <label>Member Number</label>
                            <input ng-model="search.memberNumber">
                        </md-input-container>
                    </div>
                    <div style="border-left: 1px solid #e6e6e6; width: 100% !important;">
                        <md-input-container flex-gt-sm>
                            <label>Policy Number</label>
                            <input ng-model="search.policyNumber">
                        </md-input-container>
                    </div>
                    <div style="border-left: 1px solid #e6e6e6; width: 100% !important;">
                        <md-input-container flex-gt-sm>
                            <label>Voucher Number</label>
                            <input ng-model="search.voucherNumber">
                        </md-input-container>
                    </div>
                    <div style="border-left: 1px solid #e6e6e6; width: 150% !important;">
                        <md-input-container flex-gt-sm>
                            <label>Previous Request Number</label>
                            <input ng-model="search.requestNumber">
                        </md-input-container>
                    </div>
                </div>
                <div class="searchColm align-middle text-center" ng-click="searchClaims();" style="width: auto !important;">
                    <a href="javascript:;" data-toggle="modal" data-target="#newRegClaims" class="searBtn mt-1 ml-3 mr-3 align-middle">
                        <span class="oi align-middle" data-glyph="magnifying-glass"></span>
                    </a>
                </div>
            </div>
        </div>

        <div class="resultBox mb-4" ng-class="{'mt-3' : isNew}">
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container flex-gt-sm>
                            <label>Policy Number</label>
                            <input type="text" ng-model="regDetail.policyNumber" />
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container flex-gt-sm>
                            <label>Member Number</label>
                            <input type="text" ng-model="regDetail.memberNumber" />
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container flex-gt-sm>
                            <label>Member Name</label>
                            <input type="text" ng-model="regDetail.memberName" />
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container flex-gt-sm>
                            <label>Emirates ID</label>
                            <input type="text" ng-model="regDetail.emiratesId" />
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container flex-gt-sm>
                            <label>Mobile Number 1</label>
                            <input type="number" ng-model="regDetail.mobileNum1" />
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container flex-gt-sm>
                            <label>Email ID 1</label>
                            <input type="email" ng-model="regDetail.email1" />
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container flex-gt-sm>
                            <label>Mobile Number 2</label>
                            <input type="number" ng-model="regDetail.mobileNum2" />
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container flex-gt-sm>
                            <label>Email ID 2</label>
                            <input type="email" ng-model="regDetail.email2" />
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container flex-gt-sm>
                            <label>Previous Request</label>
                            <input type="text" ng-model="regDetail.prevRequest" />
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container flex-gt-sm>
                            <label>Requested Amount</label>
                            <input type="number" ng-model="regDetail.requestAmt" />
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container flex-gt-sm>
                            <label class="focuslabel">Encounter Type</label>
                            <md-select name="EncounterType" ng-model="regDetail.encType">
                                <md-option value="inPatient">In Patient</md-option>
                                <md-option value="outPatient">Out Patient</md-option>
                            </md-select>
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container flex-gt-sm>
                            <label>Request Type</label>
                            <md-select name="EncounterType" ng-model="regDetail.reqType">
                                <md-option value="newRequest">New Request</md-option>
                                <md-option value="resubmission">Resubmission</md-option>
                            </md-select>
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div layout-gt-sm="row">
                    <div class="col-sm-6">
                        <md-input-container>
                            <label>Request Received Date</label>
                            <md-datepicker ng-keyup="clearDatepickerKeyupValue($event);" ng-model="regDetail.reqReceivedDate" md-hide-icons="triangle"
                                md-open-on-focus></md-datepicker>
                        </md-input-container>
                    </div>
                    <div class="col-sm-6 colborder">
                        <md-input-container>
                            <label>Service From Date</label>
                            <md-datepicker ng-keyup="clearDatepickerKeyupValue($event);" ng-model="regDetail.serviceFmDate" md-hide-icons="triangle"
                                md-open-on-focus></md-datepicker>
                        </md-input-container>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div class="fieldsCol fieldsFilledCol">
                    <label class="top_4">Document Type</label>
                    <div class="buttonGroups">
                        <button type="button" class="btn btn-outline-primary btn-sm" ng-class="{'btnSelect' : documentType == 'inPerson'}" ng-click="setDcoumentType('inPerson')">In Person</button>
                        <button type="button" class="btn btn-outline-primary btn-sm" ng-class="{'btnSelect' : documentType == 'email'}" ng-click="setDcoumentType('email')">Email</button>
                        <button type="button" class="btn btn-outline-primary btn-sm" ng-class="{'btnSelect' : documentType == 'post'}" ng-click="setDcoumentType('post')">Post</button>
                        <button type="button" class="btn btn-outline-primary btn-sm" ng-class="{'btnSelect' : documentType == 'tpa'}" ng-click="setDcoumentType('tpa')">TPA</button>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix">
                <div class="fieldsCol fieldsFilledCol pb-2">
                    <label class="top_4">Payment Way</label>
                    <div class="buttonGroups">
                        <button type="button" class="btn btn-outline-primary btn-sm" ng-class="{'btnSelect' : paymentWay == 'iban'}" ng-click="setPaymentWay('iban')">IBAN</button>
                        <button type="button" class="btn btn-outline-primary btn-sm" ng-class="{'btnSelect' : paymentWay == 'cheque'}" ng-click="setPaymentWay('cheque')">Cheque</button>
                    </div>
                </div>
                <div class="fldsWrap clearfix b0 row" ng-show="paymentWay == 'iban'">
                    <div class="col-sm-4">
                        <div layout-gt-sm="row">
                            <div class="pb-1 iban-box">
                                <md-input-container flex-gt-sm class="iban-input">
                                    <label>IBAN Number</label>
                                    <input type="text" ng-model="regDetail.ibanNum" />
                                </md-input-container>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4 fieldsCol fieldsFilledCol d-inline-block b0">
                        <label class="top_4 d-block grayText">Upload IBAN Document if any</label>
                        <div class="fileuploadWrap" style="float:left;">
                            <div ngf-select="uploadIbanFiles($file)" ng-disabled="ibanFile.isUploading">
                                <span class="oi align-middle mr-1" data-glyph="cloud-upload"></span> Browse Files
                            </div>
                        </div>
                        <a href="{{ibanFile.url}}" download="{{ibanFile.name}}" class="iban-filename-elipsis"> {{ibanFile.name}} </a>
                    </div>
                </div>
            </div>
            <div class="fldsWrap clearfix docFont p-2">
                <h6>Documents</h6>
                <div class="row pt-2">
                    <div class="col-sm-3">
                        <md-input-container style="margin:0px;width:100%">
                            <md-select ng-model="docTypes" multiple="true" ng-change="filterDocuments()" ng-disabled="fileInfos.length == 0" placeholder="Type">
                                <md-option value="Iban" ng-if="paymentWay == 'iban'">Iban</md-option>
                                <md-option value="Reimbursement Form">Reimbursement form</md-option>
                                <md-option value="Medical Bills">Medical bills</md-option>
                                <md-option value="Medical Bills Summary">Medical bills Summary</md-option>
                                <md-option value="Prescription">Prescription</md-option>
                                <md-option value="Other Documents">Other Documents</md-option>
                            </md-select>
                        </md-input-container>
                    </div>
                    <div class="col-sm-2">
                        <button type="button" class="btn btn-outline-primary btn-sm p1" ng-click="clearDocFilter()">Clear</button>
                    </div>
                    <div class="col-sm-7">
                        <button type="button" class="btn btn-outline-primary btn-sm float-right" ng-click="documentsUpload()">Upload</button>
                    </div>
                </div>
                <div ng-if="documents.length > 0 && uploaded" id="thumbnailSlider" ng-style="{'padding-left' : fileInfos.length > 2 ? '15px' : '0px'}"
                    class="col-sm-11">
                    <ui-carousel slides="documents" slides-to-show="noOfSlides" slides-to-scroll="noOfSlides" initial-slide="0" style="margin-bottom:0px;margin-left: 15px;padding-top: 24px;"
                        infinite="false" name="'thumbnailSlider'" ng-class="{'img-padding' : (showUpload && $odd), 'img-padding' : !showUpload}">
                        <carousel-item>
                            <div style="padding:0px 5px 2px 7px;">
                                <span href="{{item.previewUrl}}" download="{{item.name}}" style="float:left; color:#00aeef;font-size:16px;cursor:pointer;">
                                    <i class="fa fa-cloud-download"></i>
                                </span>
                                <span style="float:right; cursor:pointer;">
                                    <i class="fa fa-remove" ng-click="deleteFile($index, item.id)" style="color:red;"></i>&nbsp;&nbsp;
                                    <i class="fa fa-pencil" ng-click="openDocumentModal($index);" style="color:black;"></i>
                                </span>
                            </div>
                            <div class="thumbnail-card" ng-class="{'img-padding' : $odd}">
                                <div style="height:127px;padding:10px;">
                                    <thumbnail file-type="{{ item.ext }}" source="{{ item.previewUrl }}" max-height="118" max-width="195" class="pdf-view" ng-show="item.ext == 'image'"
                                        style="padding:5px;"></thumbnail>
                                    <thumbnail file-type="{{ item.ext }}" source="{{ item.previewUrl }}" class="pdf-view" max-height="118" max-width="195" ng-show="item.ext == 'pdf'"
                                        style="padding:5px;"></thumbnail>
                                    <div ng-show="item.ext == 'docx'">
                                        <i class="fa fa-file-word-o center" style="font-size:90px; color:#26559a; width:160px; height: 95px; text-align:center"></i>
                                    </div>
                                    <div ng-show="item.ext == 'excel'">
                                        <i class="fa fa-file-excel-o center" style="font-size:90px; color:green; width:160px; height: 95px; text-align:center"></i>
                                    </div>
                                </div>
                                <div class="upload-details">
                                    <p class="slide-text-truncate">
                                        <a href="" ng-click="showPreview($index, item)">
                                            <span>{{item.name}}</span>
                                            <br>
                                        </a>
                                        <span>Uploaded on {{item.uploadedDate | date: 'mediumDate'}}</span>
                                        <br>
                                        <!-- Type:<span>{{item.documentTyp}}</span><br>
                                        Desc:<span>{{item.documentDesc}}</span><br> -->
                                    </p>
                                    <p>
                                        <i class="fa fa-file-picture-o upload-file-icon" ng-show="item.ext == 'image'" style="color:#00aeef;"></i>
                                        <i class="fa fa-file-pdf-o upload-file-icon" ng-show="item.ext == 'pdf'" style="color:red;"></i>
                                        <i class="fa fa-file-word-o upload-file-icon" ng-show="item.ext == 'docx'" style="color:#26559a;"></i>
                                        <i class="fa fa-file-excel-o upload-file-icon" ng-show="item.ext == 'excel'" style="color:green"></i>
                                    </p>
                                </div>
                            </div>
                        </carousel-item>
                        <carousel-prev>
                            <i class="fa fa-chevron-left" style="font-size: 16px;"></i>
                        </carousel-prev>
                        <carousel-next>
                            <i class="fa fa-chevron-right" style="font-size: 16px;"></i>
                        </carousel-next>
                    </ui-carousel>
                </div>
                <div ng-if="documents.length == 0" class="pt-5" style="text-align: center"> No Documents Found</div>
            </div>

            <div class="fldsWrap pr-3 pb-2 pt-2 clearfix">
                <button type="button" class="btn btn-primary float-right" ng-click="registerClaim()">Submit</button>
            </div>
        </div>

    </div>
    <div class="rightContainer col-sm-5" ng-if="showUpload" style="height: 95vh;">
        <a href="javascript:;" class="infoToggleBtn" ng-click="toggleInfo();" style="margin-left:17px;position: absolute;top:0">
            <span class="oi" data-glyph="arrow-right"></span>
            <br />hide</a>
        <ui-carousel slides="documents" slides-to-show="1" slides-to-scroll="1" initial-slide="previewIndex" style="width:98%;height:100%; margin:39px 0px 0px 18px;"
            infinite="false" name="'previewSlider'" ng-if="documents.length > 0 && isPreview">
            <carousel-item>
                <div style="width:96%; padding:5px;">
                    <div ng-show="item.ext != 'docx' && item.ext != 'excel'" style="padding-left:5px;">
                        <iframe ng-src="{{trustUrl(item)}}" width="98%" height="590px;" ng-show="item.ext == 'pdf'"></iframe>
                        <img ng-src="{{trustUrl(item)}}" ng-show="item.ext != 'pdf'" style="width:98%;height:590px" />
                    </div>
                    <div ng-show="item.ext == 'docx' || item.ext == 'excel'" style="width:98%; height:500px;color:white;font-size:25px;text-align:center">
                        <br>
                        <br>
                        <br>No Preview Available
                    </div>
                </div>
            </carousel-item>
            <carousel-prev>
                <i class="fa fa-chevron-left" style="font-size: 20px;"></i>
            </carousel-prev>
            <carousel-next>
                <i class="fa fa-chevron-right" style="font-size: 20px;"></i>
            </carousel-next>
        </ui-carousel>
        <div class="uploadPlaceHolder" ng-hide="isPreview" ng-if="!hasMandatory" style="height:80%">
            <h2>Upload your Claim scaned copy</h2>
            <div style="padding: 0px 4px 4px 4px;">
                <div class="fldsWrap clearfix">
                    <md-input-container flex-gt-sm>
                        <label>Upload Type</label>
                        <md-select ng-model="upload.type">
                            <md-option value="Iban" ng-if="paymentWay == 'iban'">Iban</md-option>
                            <md-option value="Reimbursement Form">Reimbursement form</md-option>
                            <md-option value="Medical Bills">Medical bills</md-option>
                            <md-option value="Medical Bills Summary">Medical bills Summary</md-option>
                            <md-option value="Prescription">Prescription</md-option>
                            <md-option value="Other Documents">Other Documents</md-option>
                        </md-select>
                    </md-input-container>
                </div>
                <div class="fldsWrap clearfix">
                    <md-input-container flex-gt-sm>
                        <label>Upload Description</label>
                        <input type="text" ng-model="upload.description">
                    </md-input-container>
                </div>
            </div>
            <div ngf-drop ngf-select ng-model="files" class="drop-box" ngf-drag-over-class="'dragover'" ngf-multiple="true" ngf-allow-dir="true"
                ngf-change="uploadFiles($files, null)" ng-show="upload.type">
                <span class="oi align-middle mr-1" data-glyph="cloud-upload" style="color:#00aeef"></span>
                Drop Files or click to upload
            </div>
        </div>
        <div ng-repeat="f in files" ng-style="{'padding-top' : $first ? '25px' : '20px'}" ng-hide="uploaded || isPreview" ng-if="!hasMandatory">
            {{f.name}}
            <div style="background : #ccc!important; height:3px !important">
                <div class="fprogress" style="width:{{f.progress}}%" ng-show="f.progress >= 0"></div>
            </div>
        </div>
        <div id="mandatoryUpload" class="uploadPlaceHolder" ng-hide="isPreview" ng-if="hasMandatory">
            <h2>Upload your Claim scaned copy</h2>
            <uib-accordion close-others="false">
                <div uib-accordion-group class="panel-default" is-open="isOpen" ng-init="isOpen = (doc.isRequired && !doc.files)" ng-repeat="doc in documentTypes | orderBy:'isRequired' : true"
                    ngf-drop="uploadFiles($files, doc)" ngf-drag-over-class="'dragover'" ngf-multiple="true" ngf-allow-dir="true">
                    <uib-accordion-heading>
                        <div class="acc-header">
                            {{doc.label}}
                            <!-- ({{!doc.files ? 0 : doc.files.length}}) -->
                            <span style="color:red;" ng-show="doc.isRequired">*</span>
                            <span class="oi expanded" data-glyph="chevron-bottom"></span>
                            <span class="oi collapsed" data-glyph="chevron-top"></span>
                        </div>

                    </uib-accordion-heading>
                    <div ngf-select ng-model="files" class="drop-box" ngf-drag-over-class="'dragover'" ngf-multiple="true" ngf-allow-dir="true"
                        ngf-change="uploadFiles($files, doc)">
                        <span class="oi align-middle mr-1" data-glyph="cloud-upload" style="color:#00aeef"></span>
                        Drop Files or click to upload
                    </div>
                </div>
            </uib-accordion>
        </div>
    </div>
</section>